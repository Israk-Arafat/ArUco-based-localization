<launch>
  <!-- ArUco Localization System Launch File -->
  <!-- This launch file starts the complete localization stack with the simulator -->
  
  <arg name="marker_map_file" default="marker_map.yaml" 
       description="YAML file containing marker positions"/>
  <arg name="use_simulator" default="true" 
       description="Start the simulator node"/>
  <arg name="show_animation" default="true" 
       description="Show matplotlib animation in simulator"/>
  
  <!-- Static TF: marker positions in map frame -->
  <node pkg="py_pubsub" exec="marker_tf_publisher" name="marker_tf_publisher" output="screen">
    <param name="marker_map_file" value="$(var marker_map_file)"/>
    <param name="map_frame" value="map"/>
  </node>
  
  <!-- Static TF: camera to base_link (adjust based on your robot) -->
  <node pkg="tf2_ros" exec="static_transform_publisher" name="camera_to_base" 
        args="0.1 0 0.15 0 0 0 base_link camera_link" output="screen"/>
  
  <!-- ArUco Localization Node -->
  <node pkg="py_pubsub" exec="aruco_localizer" name="aruco_localizer" output="screen">
    <param name="marker_map_file" value="$(var marker_map_file)"/>
    <param name="camera_frame" value="camera_link"/>
    <param name="base_frame" value="base_link"/>
    <param name="map_frame" value="map"/>
    <param name="use_closest_marker" value="true"/>
    <param name="max_marker_distance" value="5.0"/>
  </node>
  
  <!-- ArUco Simulator (optional, for testing without real camera) -->
  <node pkg="py_pubsub" exec="aruco_simulator" name="aruco_simulator" 
        if="$(var use_simulator)" output="screen">
    <param name="show_animation" value="$(var show_animation)"/>
  </node>
  
</launch>
